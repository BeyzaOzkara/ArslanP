{% extends 'adminlte/base.html' %}
{% block body_class %}
  {% block bodyclass %}
    sidebar-collapse
  {% endblock %}
{% endblock %}

{% load static %}

{% block title %}
  Arslan Alüminyum
{% endblock %}

{% block stylesheets %}
  {% include 'adminlte/lib/_styles.html' %}
  <link rel="stylesheet" type="text/css" href="{% static 'tabulator/dist/css/tabulator_bootstrap5.min.css' %}">
{% endblock %}

{% block content %}

<div class="container col-lg-12">
  <h1 class="col-lg-11" style="text-align: center;">Arslan Alüminyum Ek Sipariş Listesi</h1>
  <div id="ekSiparisTable"></div>
</div>

{% endblock %}

{% block extra_js %}

<script>

  var headerMenu = function(){
    var menu = [];
    var columns = this.getColumns();

    for(let column of columns){
        if (column.getDefinition().title != ""){
        //create checkbox element using font awesome icons
            let icon = document.createElement("i");
            icon.classList.add("fas");
            
            icon.classList.add(column.isVisible() ? "fa-check-square" : "fa-square");
            
            //build label
            let label = document.createElement("span");
            let title = document.createElement("span");

            
            title.textContent = " " + column.getDefinition().title;
            label.appendChild(icon);
            label.appendChild(title);

            //create menu item
            menu.push({
                label:label,
                action:function(e){
                    //prevent menu closing
                    e.stopPropagation();
                    //toggle current column visibility
                    column.toggle();

                    //change menu item icon
                    if(column.isVisible()){
                        icon.classList.remove("fa-square");
                        icon.classList.add("fa-check-square");
                    }else{
                        icon.classList.remove("fa-check-square");
                        icon.classList.add("fa-square");
                    }
                }
            });
    }};

    return menu;
  };

  var ekSiparisTable = new Tabulator("#ekSiparisTable", {
    height:"700px",
    layout:"fitDataFill",
    placeholder:"Ek Sipariş Liste",
    ajaxURL:"/eksiparis/list",
    ajaxURLGenerator:function(url, config, params){
        return url + "?params=" + encodeURI(JSON.stringify(params)); //encode parameters as a json object
    },
    progressiveLoad:"scroll",
    paginationMode:"remote",
    filterMode:"remote",
    paginationSize:30,
    popupContainer:true,
    movableRows:true,
    columns:[
        {rowHandle:true, formatter:"handle", title:"", headerMenu:headerMenu, headerSort:false, frozen:true, width:30, minWidth:30},
        {title:"Kart No", field:"SipKartNo"},
        {title:"Ek No", field:"EkNo"},
        {title:"Profil No", field:"ProfilNo"},
        {title:"Ek Pres Kodu", field:"EkPresKodu"},
        {title:"Ek Termin", field:"EkTermin"},
        {title:"Ek Kg", field:"EkKg"},
        {title:"Firma Adı", field:"FirmaAdi", visible:false},
        {title:"Billet Türü", field:"BilletTuru"},
        {title:"Son Termin", field:"SonTermin", visible:false},
        {title:"Sipariş Kg", field:"GirenKg"},
        {title:"Kalan Kg", field:"Kg"},
        {title:"Kondüsyon Türü", field:"KondusyonTuru"},
        {title:"Toplam Kalan Tenifer", field:"TopTenKg", visible:false},
    ],
  });


</script>

{% endblock %}

{% block javascript %}
{% include 'adminlte/lib/_scripts.html' %}
<script src="{% static 'tabulator/dist/js/tabulator.js' %} "></script>

{% endblock %}
